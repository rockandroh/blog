wday = 3 # 화요일
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# # start 세팅값 7=토요일 // 1=일요일
# if(wday(date) == 7 || wday(date) == 1){
#   mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# }
# # 주중
# else {
#   mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# }
return(mydate)
}
golf1; golf2; golf3; golf4
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4)
golf1; golf2; golf3; golf4
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4)
golf1; golf2; golf3; golf4; golf5
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# # start 세팅값 7=토요일 // 1=일요일
# if(wday(date) == 7 || wday(date) == 1){
#   mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# }
# # 주중
# else {
#   mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# }
return(mydate)
}
golf1; golf2; golf3; golf4; golf5
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# # start 세팅값 7=토요일 // 1=일요일
# if(wday(date) == 7 || wday(date) == 1){
#   mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# }
# # 주중
# else {
#   mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# }
return(mydate)
}
golf1; golf2; golf3; golf4; golf5
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5)
golf1 = as.Date('2020-12-11') #금요일
golf2 = as.Date('2020-12-14') #월요일
golf3 = as.Date('2020-12-19') #토요일
golf4 = as.Date('2020-12-20') #일요일
golf5 = as.Date('2020-12-21') #월요일
prev_n_weekday = function(date, wday, n=1, start = 'Sun'){
date = as.Date(date)
if (start == 'Sat'){
k = 6
}
else if(start == 'Fri'){
k = 5
}
else if(start == 'Sun'){
k = 7
}
else if(start == 'Mon'){
k = 1
}
diff = wday - wday(date, week_start = k)
diff = diff - 7*n
mydate = date + diff
return(mydate)
}
# 청도 그레이스
grace = function(date){
date = as.Date(date)
mydate = prev_n_weekday(date, wday(date), 2)
return(mydate)
}
golf1; golf2; golf3; golf4
grace(golf1);grace(golf2); grace(golf3); grace(golf4)
golf1; golf2; golf3; golf4; golf5
grace(golf1);grace(golf2); grace(golf3); grace(golf4); grace(golf5)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# # start 세팅값 7=토요일 // 1=일요일
# if(wday(date) == 7 || wday(date) == 1){
#   mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
# }
# # 주중
# else {
#   mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# }
return(mydate)
}
golf1; golf2; golf3; golf4; golf5
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5)
golf1; golf2; golf3; golf4; golf5; golf6
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5); ophel(golf6)
golf6 = as.Date('2020-12-26') #토요일
golf1; golf2; golf3; golf4; golf5; golf6
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5); ophel(golf6)
golf1; golf2; golf3; golf4; golf5; golf6
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5); ophel(golf6)
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
if(wday(date) == 7 || wday(date) == 1){
mydate = prev_n_weekday(date, wday, 1)
}
else {
mydate = prev_n_weekday(date, wday, 2)
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
guni(golf1);guni(golf2); guni(golf3); guni(golf4); guni(golf5); guni(golf6)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5); ophel(golf6)
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1)
}
else {
mydate = prev_n_weekday(date, wday, 2)
}
return(mydate)
}
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
guni(golf1);guni(golf2); guni(golf3); guni(golf4); guni(golf5); guni(golf6)
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7 || wday(date) == 1){
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
guni(golf1);guni(golf2); guni(golf3); guni(golf4); guni(golf5); guni(golf6)
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7 || wday(date) == 1){
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
guni(golf1);guni(golf2); guni(golf3); guni(golf4); guni(golf5); guni(golf6)
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
else if(wday(date) == 1){
mydate = prev_n_weekday(date, wday, 3, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
guni(golf1);guni(golf2); guni(golf3); guni(golf4); guni(golf5); guni(golf6)
# 창녕 동훈힐마루 (비회원기준)
hilmaru = function(date){
date = as.Date(date)
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday = 6, 2, start = 'Sun')
}
else if(wday(date) == 6){
mydate = prev_n_weekday(date, wday = 6, 3, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday = 3, 3, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
hilmaru(golf1);hilmaru(golf2); hilmaru(golf3); hilmaru(golf4); hilmaru(golf5); hilmaru(golf6)
# 창녕 동훈힐마루 (비회원기준)
hilmaru = function(date){
date = as.Date(date)
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday = 6, 2, start = 'Sun')
}
else if(wday(date) == 1){
mydate = prev_n_weekday(date, wday = 6, 3, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday = 3, 3, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
hilmaru(golf1);hilmaru(golf2); hilmaru(golf3); hilmaru(golf4); hilmaru(golf5); hilmaru(golf6)
# 창녕 동훈힐마루 (비회원기준)
hilmaru = function(date){
date = as.Date(date)
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday = 6, 3, start = 'Sun')
}
else if(wday(date) == 1){
mydate = prev_n_weekday(date, wday = 6, 4, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday = 3, 3, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
hilmaru(golf1);hilmaru(golf2); hilmaru(golf3); hilmaru(golf4); hilmaru(golf5); hilmaru(golf6)
# 세븐밸리
valley = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
printf <- function(...) cat(sprintf(...))
# 세븐밸리
valley = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
valley(golf1);valley(golf2);valley(golf3);valley(golf4);valley(golf5); valley(golf6)
# 마스터피스
master = function(date){
date = as.Date(date)
mydate = prev_n_weekday(date, wday(date), 3)
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
master(golf1);master(golf2);master(golf3);master(golf4);master(golf5);master(golf6)
library(shiny)
library(DT)
library(lubridate)
source(cal_dates.R)
library('shiny')
library('DT')
library('lubridate')
source('cal_dates.R')
getwd()
library('shiny')
library('DT')
library('lubridate')
source('cal_dates.R')
prev_n_weekday = function(date, wday, n){
date = as.Date(date)
diff = wday - wday(date)
if( diff <= 0)
diff = diff - 7*n
return(date + diff)
}
library(lubridate)
printf <- function(...) cat(sprintf(...))
golf1 = as.Date('2020-12-11') #금요일
golf2 = as.Date('2020-12-14') #월요일
golf3 = as.Date('2020-12-19') #토요일
golf4 = as.Date('2020-12-20') #일요일
golf5 = as.Date('2020-12-21') #월요일
golf6 = as.Date('2020-12-26') #토요일
nextweekday <- function(date, wday) {
date <- as.Date(date)
diff <- wday - wday(date)
if( diff < 0 )
diff <- diff + 7
return(date + diff)
}
prev_n_weekday = function(date, wday, n=1, start = 'Sun'){
date = as.Date(date)
if (start == 'Sat'){
k = 6
}
else if(start == 'Fri'){
k = 5
}
else if(start == 'Sun'){
k = 7
}
else if(start == 'Mon'){
k = 1
}
diff = wday - wday(date, week_start = k)
diff = diff - 7*n
mydate = date + diff
return(mydate)
}
# 청도 그레이스
grace = function(date){
date = as.Date(date)
mydate = prev_n_weekday(date, wday(date), 2)
return(mydate)
}
golf1; golf2; golf3; golf4; golf5
grace(golf1);grace(golf2); grace(golf3); grace(golf4); grace(golf5)
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
golf1; golf2; golf3; golf4; golf5; golf6
ophel(golf1);ophel(golf2); ophel(golf3); ophel(golf4); ophel(golf5); ophel(golf6)
club_name = c('그레이스','군위오펠','군위구니','힐마루','세븐밸리','마스터피스')
club_name
club_name[order(club_name)]
club_name = c('군위구니','군위오펠','그레이스','마스터피스',
'세븐밸리','힐마루')
#' Calculate date function
printf <- function(...) cat(sprintf(...))
prev_n_weekday = function(date, wday, n=1, start = 'Sun'){
date = as.Date(date)
if (start == 'Sat'){
k = 6
}
else if(start == 'Fri'){
k = 5
}
else if(start == 'Sun'){
k = 7
}
else if(start == 'Mon'){
k = 1
}
diff = wday - wday(date, week_start = k)
diff = diff - 7*n
mydate = date + diff
return(mydate)
}
# 청도 그레이스
grace = function(date){
date = as.Date(date)
mydate = prev_n_weekday(date, wday(date), 2)
return(mydate)
}
# 군위 군위오펠
ophel = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
# 군위 구니cc
guni = function(date){
date = as.Date(date)
wday = 3
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
else if(wday(date) == 1){
mydate = prev_n_weekday(date, wday, 3, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
# 창녕 동훈힐마루 (비회원기준)
hilmaru = function(date){
date = as.Date(date)
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday = 6, 3, start = 'Sun')
}
else if(wday(date) == 1){
mydate = prev_n_weekday(date, wday = 6, 4, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday = 3, 3, start = 'Sun')
}
return(mydate)
}
# 세븐밸리
valley = function(date){
date = as.Date(date)
wday = 3 # 화요일
# start 세팅값 7=토요일 // 1=일요일
if(wday(date) == 7){
mydate = prev_n_weekday(date, wday, 1, start = 'Sun')
}
# 주중
else {
mydate = prev_n_weekday(date, wday, 2, start = 'Sun')
}
return(mydate)
}
# 마스터피스
master = function(date){
date = as.Date(date)
mydate = prev_n_weekday(date, wday(date), 3)
return(mydate)
}
open_date = c(guni(input$date),
ophel(input$date),
grace(input$date),
master(input$date),
valley(input$date),
hilmaru(input$date))

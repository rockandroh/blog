res2_df = data.frame(group1 = unique(df_all$gender)[1],
group2 = unique(df_all$gender)[2],
labels = paste('p-val = ', round(res2$p.value, 3))
)
df_dist %>%
ggplot(., aes(x=gender, y=Mean, fill=gender))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=(df_dist$Mean[which.max(df_dist$Mean)]+
df_dist$SEM[which.max(df_dist$Mean)] + 30),
tip_length = 0.05
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
geom_text(aes(label=paste('n = ',Nb)), vjust=-0.5, hjust=2, size=3,
inherit.aes = TRUE)+
labs(y='평균',title='남자/여자 (R1) & T-test')+
theme_bw() +
scale_x_discrete(name='')+
expand_limits(y=c(NA,
df_dist$Mean[which.max(df_dist$Mean)]+
df_dist$SEM[which.max(df_dist$Mean)] + 50))+
ggsave('/Users/master/Documents/Taeho/plot/성별_r1_t_test_plot.png',
width = 6,
height = 6)
df_dist %>%
ggplot(., aes(x=gender, y=Mean, fill=gender))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res2_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=(df_dist$Mean[which.max(df_dist$Mean)]+
df_dist$SEM[which.max(df_dist$Mean)] + 30),
tip_length = 0.05
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
geom_text(aes(label=paste('n = ',Nb)), vjust=-0.5, hjust=2, size=3,
inherit.aes = TRUE)+
labs(y='평균',title='남자/여자 (R1) & Wilcoxon')+
theme_bw() +
scale_x_discrete(name='')+
expand_limits(y=c(NA,
df_dist$Mean[which.max(df_dist$Mean)]+
df_dist$SEM[which.max(df_dist$Mean)] + 50))+
ggsave('/Users/master/Documents/Taeho/plot/성별_r1_Wilcoxon_plot.png',
width = 6,
height = 6)
df_dg = df_all %>%
group_by(dg1) %>%
summarise(Mean = mean(value),
SEM = sd(value)/sqrt(n()),
Nb = n()) %>%
rowwise() %>%
mutate(Labels = as.character(dg1)) %>%
mutate(Labels = paste0(Labels,"\nn = ",Nb))
df_dg
anova.fit <- aov(formula = value ~ dg1, data = df_all)
t <- TukeyHSD(anova.fit)
stat <- t$dg1
res_df <- stat %>% as.data.frame() %>%
mutate(Variable = "dg1") %>%
mutate(Group = rownames(stat)) %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Group,"-"))[1]) %>%
mutate(group2 = unlist(strsplit(Group,"-"))[2]) %>%
mutate(labels = paste('p-val = ', round(`p adj`,3)))
kw = kruskal.test(value ~ dg1,
data = df_all)
print(kw)
res2 = pairwise.wilcox.test(df_all$value, df_all$dg1,
p.adjust.method = "BH")
ind = which(lower.tri(res2$p.value, diag=TRUE), arr.ind = TRUE)
res2_df = data.frame(group1 = dimnames(res2$p.value)[[2]][ind[,2]],
group2 = dimnames(res2$p.value)[[1]][ind[,1]],
labels = paste('p-val = ', round(res2$p.value[ ind ], 3))) %>%
arrange(group1)
print(res2_df)
res3 = dunnTest(df_all$value, df_all$dg1,
method = 'bh')
print(res3$res)
res3_df = res3$res %>% as.data.frame() %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Comparison," - "))[1]) %>%
mutate(group2 = unlist(strsplit(Comparison," - "))[2]) %>%
mutate(labels = paste('p-val = ', round(`P.adj`,3))) %>%
select(group1, group2, labels) %>%
arrange(group1)
#order(res3_df$group1)
df_dg %>%
ggplot(., aes(x=dg1, y=Mean, fill=dg1))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/거리 & T-test')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_거리_t_test_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg1, y=Mean, fill=dg1))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res2_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/거리 & Wilcoxon')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_거리_Wilcoxon_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg1, y=Mean, fill=dg1))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res3_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/거리 & Dunn')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_거리_Dunn_plot.png',
width = 6,
height = 6)
df_dg = df_all %>%
group_by(dg2) %>%
summarise(Mean = mean(value),
SEM = sd(value)/sqrt(n()),
Nb = n()) %>%
rowwise() %>%
mutate(Labels = as.character(dg2)) %>%
mutate(Labels = paste0(Labels,"\nn = ",Nb))
df_dg
anova.fit <- aov(formula = value ~ dg2, data = df_all)
#summary(anova.fit)
t <- TukeyHSD(anova.fit)
stat <- t$dg2
res_df <- stat %>% as.data.frame() %>%
mutate(Variable = "dg2") %>%
mutate(Group = rownames(stat)) %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Group,"-"))[1]) %>%
mutate(group2 = unlist(strsplit(Group,"-"))[2]) %>%
mutate(labels = paste('p-val = ', round(`p adj`,3))) %>%
mutate(colors = ifelse(test = round(`p adj`,3)<0.1, 'a', 'e'))
kw = kruskal.test(value ~ dg2,
data = df_all)
print(kw)
res2 = pairwise.wilcox.test(df_all$value, df_all$dg2,
p.adjust.method = "BH")
ind = which(lower.tri(res2$p.value, diag=TRUE), arr.ind = TRUE)
res2_df = data.frame(group1 = dimnames(res2$p.value)[[2]][ind[,2]],
group2 = dimnames(res2$p.value)[[1]][ind[,1]],
labels = paste('p-val = ', round(res2$p.value[ ind ], 3)))
print(res2_df)
res3 = dunnTest(df_all$value, df_all$dg2,
method = 'bh')
print(res3$res)
res3_df = res3$res %>% as.data.frame() %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Comparison," - "))[1]) %>%
mutate(group2 = unlist(strsplit(Comparison," - "))[2]) %>%
mutate(labels = paste('p-val = ', round(`P.adj`,3))) %>%
select(group1, group2, labels) %>%
arrange(group1)
df_dg %>%
ggplot(., aes(x=dg2, y=Mean, fill=dg2))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/성별 & T-test')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_성별_t_test_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg2, y=Mean, fill=dg2))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res2_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/성별 & Wilcoxon')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_성별_Wilcoxon_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg2, y=Mean, fill=dg2))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res3_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
y_position=c(seq(320, 650, length.out = 6)),
tip_length = 0.01
),
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='집단/성별 & Dunn')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/집단_성별_Dunn_plot.png',
width = 6,
height = 6)
df_dg = df_all %>%
group_by(dg3) %>%
summarise(Mean = mean(value),
SEM = sd(value)/sqrt(n()),
Nb = n()) %>%
rowwise() %>%
mutate(Labels = as.character(dg3)) %>%
mutate(Labels = paste0(Labels,"\nn = ",Nb))
df_dg
anova.fit <- aov(formula = value ~ dg3, data = df_all)
#summary(anova.fit)
t <- TukeyHSD(anova.fit)
stat <- t$dg3
res_df <- stat %>% as.data.frame() %>%
mutate(Variable = "dg3") %>%
mutate(Group = rownames(stat)) %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Group,"-"))[1]) %>%
mutate(group2 = unlist(strsplit(Group,"-"))[2]) %>%
mutate(labels = paste('p-val = ', round(`p adj`,3))) %>%
mutate(colors = ifelse(test = round(`p adj`,3)<0.1, 'a', 'e'))
kw = kruskal.test(value ~ dg3,
data = df_all)
print(kw)
res2 = pairwise.wilcox.test(df_all$value, df_all$dg3,
p.adjust.method = "BH")
ind = which(lower.tri(res2$p.value, diag=TRUE), arr.ind = TRUE)
res2_df = data.frame(group1 = dimnames(res2$p.value)[[2]][ind[,2]],
group2 = dimnames(res2$p.value)[[1]][ind[,1]],
labels = paste('p-val = ', round(res2$p.value[ ind ], 3)))
print(res2_df)
res3 = dunnTest(df_all$value, df_all$dg3,
method = 'bh')
print(res3)
res3_df = res3$res %>% as.data.frame() %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Comparison," - "))[1]) %>%
mutate(group2 = unlist(strsplit(Comparison," - "))[2]) %>%
mutate(labels = paste('p-val = ', round(`P.adj`,3))) %>%
select(group1, group2, labels) %>%
arrange(group1)
df_dg %>%
ggplot(., aes(x=dg3, y=Mean, fill=dg3))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(350, 650, length.out = 6)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='거리/성별 & T-test')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/거리_성별_t_test_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg3, y=Mean, fill=dg3))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res2_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(350, 650, length.out = 6)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='거리/성별 & Wilcoxon')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/거리_성별_Wilcoxon_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=dg3, y=Mean, fill=dg3))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res3_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(350, 650, length.out = 6)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='거리/성별 & Dunn')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-0.5, hjust=1.5, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/거리_성별_Dunn_plot.png',
width = 6,
height = 6)
df_dg = df_char %>%
group_by(char) %>%
summarise(Mean = mean(value),
SEM = sd(value)/sqrt(n()),
Nb = n()) %>%
rowwise() %>%
mutate(Labels = as.character(char)) %>%
mutate(Labels = paste0(Labels,"\nn = ",Nb))
df_dg
#levels(as.factor(df_char$char))
df$char = as.factor(df$char)
#df$char
res = aov(value ~ char, data = df_char)
anova.fit <- aov(formula = value ~ char, data = df_all)
#summary(anova.fit)
t <- TukeyHSD(anova.fit)
stat <- t$char
res_df <- stat %>% as.data.frame() %>%
mutate(Variable = "char") %>%
mutate(Group = rownames(stat)) %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Group,"-"))[1]) %>%
mutate(group2 = unlist(strsplit(Group,"-"))[2]) %>%
mutate(labels = paste('p-val = ', round(`p adj`,3))) %>%
mutate(colors = ifelse(test = round(`p adj`,3)<0.1, 'a', 'e'))
kw = kruskal.test(value ~ char,
data = df_char)
print(kw)
res2 = pairwise.wilcox.test(df_char$value, df_char$char,
p.adjust.method = "BH")
ind = which(lower.tri(res2$p.value, diag=TRUE), arr.ind = TRUE)
res2_df = data.frame(group1 = dimnames(res2$p.value)[[2]][ind[,2]],
group2 = dimnames(res2$p.value)[[1]][ind[,1]],
labels = paste('p-val = ', round(res2$p.value[ ind ], 3)))
res2_df
res3 = dunnTest(df_char$value, df_char$char,
method = 'bh')
res3
res3_df = res3$res %>% as.data.frame() %>%
rowwise() %>%
mutate(group1 = unlist(strsplit(Comparison," - "))[1]) %>%
mutate(group2 = unlist(strsplit(Comparison," - "))[2]) %>%
mutate(labels = paste('p-val = ', round(`P.adj`,3))) %>%
select(group1, group2, labels) %>%
arrange(group1)
df_dg %>%
ggplot(., aes(x=char, y=Mean, fill=char))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(450, 1000, length.out = 10)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='성격 & T-test')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-1.2, hjust=1.7, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/성격_t_test_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=char, y=Mean, fill=char))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res2_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(450, 1000, length.out = 10)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='성격 & Wilcoxon')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-1.2, hjust=1.7, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/성격_Wilcoxon_plot.png',
width = 6,
height = 6)
df_dg %>%
ggplot(., aes(x=char, y=Mean, fill=char))+
geom_bar(stat='identity', show.legend=FALSE)+
geom_errorbar(aes(ymin=Mean-SEM, ymax = Mean+SEM), width=0.2)+
geom_signif(inherit.aes = FALSE, data = res3_df,
aes(xmin=group1, xmax = group2,
annotations = labels,
#color=colors,
y_position=c(seq(450, 1000, length.out = 10)),
tip_length = 0.01,
),
show.legend = FALSE,
vjust=-0.2,
textsize = 3,
manual=TRUE
)+
labs(y='평균',title='성격 & Dunn')+
expand_limits(y=c(NA,700))+
geom_text(aes(label=paste('n =',Nb)), vjust=-1.2, hjust=1.7, size=3,
inherit.aes = TRUE)+
theme_bw() +
scale_x_discrete(name='')+
ggsave('/Users/master/Documents/Taeho/plot/성격_Dunn_plot.png',
width = 6,
height = 6)
